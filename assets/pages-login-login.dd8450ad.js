import{c as e,s as t,v as a,d as n,k as l,x as o,D as r,I as s,p as i,L as u,j as c,q as d,f as g,t as m,F as p,E as f,G as v,A as h,i as b,J as y,m as S,K as x,M as w,y as k,N as V,O as B,g as C,a as M,P,Q as T,R as E,S as I,C as A}from"./index.4a5b450a.js";import{k as z,b as $,p as q,m as j,g as L,q as W,x as F,f as D,j as O,h as R,s as _,u as H,y as K,z as U,o as G,c as J,w as N,e as Q}from"./index-cbb82d8a.js";import{_ as X}from"./plugin-vueexport-helper.1b428a4d.js";const[Y,Z]=e("button");const ee=c(z({name:Y,props:t({},a,{tag:n("button"),text:String,icon:String,type:n("default"),size:n("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:n("button"),loadingSize:l,loadingText:String,loadingType:String,iconPosition:n("left")}),emits:["click"],setup(e,{emit:t,slots:a}){const n=o(),l=()=>e.loading?a.loading?a.loading():$(u,{size:e.loadingSize,type:e.loadingType,class:Z("loading")},null):a.icon?$("div",{class:Z("icon")},[a.icon()]):e.icon?$(s,{name:e.icon,class:Z("icon"),classPrefix:e.iconPrefix},null):void 0,c=()=>{let t;if(t=e.loading?e.loadingText:a.default?a.default():e.text,t)return $("span",{class:Z("text")},[t])},d=()=>{const{color:t,plain:a}=e;if(t){const e={color:a?t:"white"};return a||(e.background=t),t.includes("gradient")?e.border=0:e.borderColor=t,e}},g=a=>{e.loading?i(a):e.disabled||(t("click",a),n())};return()=>{const{tag:t,type:a,size:n,block:o,round:s,plain:i,square:u,loading:m,disabled:p,hairline:f,nativeType:v,iconPosition:h}=e,b=[Z([a,n,{plain:i,block:o,round:s,square:u,loading:m,disabled:p,hairline:f}]),{[r]:f}];return $(t,{type:v,class:b,style:d(),disabled:p,onClick:g},{default:()=>[$("div",{class:Z("content")},["left"===h&&l(),c(),"right"===h&&l()])]})}}}));let te=0;const[ae,ne]=e("form");const le=c(z({name:ae,props:{colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:l,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:m,showErrorMessage:m,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}},emits:["submit","failed"],setup(e,{emit:t,slots:a}){const{children:n,linkChildren:l}=d(p),o=e=>e?n.filter((t=>e.includes(t.name))):n,r=t=>{return"string"==typeof t?(e=>{const t=n.find((t=>t.name===e));return t?new Promise(((e,a)=>{t.validate().then((t=>{t?a(t):e()}))})):Promise.reject()})(t):e.validateFirst?(a=t,new Promise(((e,t)=>{const n=[];o(a).reduce(((e,t)=>e.then((()=>{if(!n.length)return t.validate().then((e=>{e&&n.push(e)}))}))),Promise.resolve()).then((()=>{n.length?t(n):e()}))}))):(e=>new Promise(((t,a)=>{const n=o(e);Promise.all(n.map((e=>e.validate()))).then((e=>{(e=e.filter(Boolean)).length?a(e):t()}))})))(t);var a},s=(e,t)=>{n.some((a=>a.name===e&&(a.$el.scrollIntoView(t),!0)))},u=()=>n.reduce(((e,t)=>(void 0!==t.name&&(e[t.name]=t.formValue.value),e)),{}),c=()=>{const a=u();r().then((()=>t("submit",a))).catch((n=>{t("failed",{values:a,errors:n}),e.scrollToError&&n[0].name&&s(n[0].name)}))},m=e=>{i(e),c()};return l({props:e}),g({submit:c,validate:r,getValues:u,scrollToField:s,resetValidation:e=>{"string"==typeof e&&(e=[e]);o(e).forEach((e=>{e.resetValidation()}))},getValidationStatus:()=>n.reduce(((e,t)=>(e[t.name]=t.getValidationStatus(),e)),{})}),()=>{var e;return $("form",{class:ne(),onSubmit:m},[null==(e=a.default)?void 0:e.call(a)])}}}));function oe(e){return Array.isArray(e)?!e.length:0!==e&&!e}function re(e,t){const{message:a}=t;return y(a)?a(e,t):a||""}function se({target:e}){e.composing=!0}function ie({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function ue(e){return[...e].length}function ce(e,t){return[...e].slice(0,t).join("")}const[de,ge]=e("field");const me=c(z({name:de,props:t({},x,{id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:l,formatter:Function,clearIcon:n("clear"),modelValue:S(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:n("focus"),formatTrigger:n("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},{rows:l,type:n("text"),rules:Array,autosize:[Boolean,Object],labelWidth:l,labelClass:w,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}}),emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:a}){const n=function(){const e=q(),{name:t="unknown"}=(null==e?void 0:e.type)||{};return`${t}-${++te}`}(),l=j({status:"unvalidated",focused:!1,validateMessage:""}),o=L(),r=L(),u=L(),{parent:c}=k(p),d=()=>{var t;return String(null!=(t=e.modelValue)?t:"")},m=t=>P(e[t])?e[t]:c&&P(c.props[t])?c.props[t]:void 0,y=W((()=>{const t=m("readonly");if(e.clearable&&!t){const t=""!==d(),a="always"===e.clearTrigger||"focus"===e.clearTrigger&&l.focused;return t&&a}return!1})),S=W((()=>u.value&&a.input?u.value():e.modelValue)),x=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===l.status)return;let{value:e}=S;if(t.formatter&&(e=t.formatter(e,t)),!function(e,t){if(oe(e)){if(t.required)return!1;if(!1===t.validateEmpty)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}(e,t))return l.status="failed",void(l.validateMessage=re(e,t));if(t.validator){if(oe(e)&&!1===t.validateEmpty)return;return function(e,t){return new Promise((a=>{const n=t.validator(e,t);b(n)?n.then(a):a(n)}))}(e,t).then((a=>{a&&"string"==typeof a?(l.status="failed",l.validateMessage=a):!1===a&&(l.status="failed",l.validateMessage=re(e,t))}))}}))),Promise.resolve()),w=()=>{l.status="unvalidated",l.validateMessage=""},A=()=>t("endValidate",{status:l.status,message:l.validateMessage}),z=(a=e.rules)=>new Promise((n=>{w(),a?(t("startValidate"),x(a).then((()=>{"failed"===l.status?(n({name:e.name,message:l.validateMessage}),A()):(l.status="passed",n(),A())}))):n()})),K=t=>{if(c&&e.rules){const{validateTrigger:a}=c.props,n=T(a).includes(t),l=e.rules.filter((e=>e.trigger?T(e.trigger).includes(t):n));l.length&&z(l)}},U=(a,n="onChange")=>{const r=a;a=(t=>{var a;const{maxlength:n}=e;if(P(n)&&ue(t)>+n){const e=d();if(e&&ue(e)===+n)return e;const r=null==(a=o.value)?void 0:a.selectionEnd;if(l.focused&&r){const e=[...t],a=e.length-+n;return e.splice(r-a,a),e.join("")}return ce(t,+n)}return t})(a);const s=ue(r)-ue(a);if("number"===e.type||"digit"===e.type){const t="number"===e.type;a=E(a,t,t)}let i=0;if(e.formatter&&n===e.formatTrigger){const{formatter:t,maxlength:n}=e;if(a=t(a),P(n)&&ue(a)>+n&&(a=ce(a,+n)),o.value&&l.focused){const{selectionEnd:e}=o.value,a=ce(r,e);i=ue(t(a))-ue(a)}}if(o.value&&o.value.value!==a)if(l.focused){let{selectionStart:e,selectionEnd:t}=o.value;if(o.value.value=a,P(e)&&P(t)){const n=ue(a);s?(e-=s,t-=s):i&&(e+=i,t+=i),o.value.setSelectionRange(Math.min(e,n),Math.min(t,n))}}else o.value.value=a;a!==e.modelValue&&t("update:modelValue",a)},G=e=>{e.target.composing||U(e.target.value)},J=()=>{var e;return null==(e=o.value)?void 0:e.blur()},N=()=>{var e;return null==(e=o.value)?void 0:e.focus()},Q=()=>{const t=o.value;"textarea"===e.type&&e.autosize&&t&&function(e,t){const a=f();e.style.height="auto";let n=e.scrollHeight;if(h(t)){const{maxHeight:e,minHeight:a}=t;void 0!==e&&(n=Math.min(n,e)),void 0!==a&&(n=Math.max(n,a))}n&&(e.style.height=`${n}px`,v(a))}(t,e.autosize)},X=e=>{l.focused=!0,t("focus",e),O(Q),m("readonly")&&J()},Y=e=>{l.focused=!1,U(d(),"onBlur"),t("blur",e),m("readonly")||(K("onBlur"),O(Q),I())},Z=e=>t("clickInput",e),ee=e=>t("clickLeftIcon",e),ae=e=>t("clickRightIcon",e),ne=W((()=>"boolean"==typeof e.error?e.error:!(!c||!c.props.showError||"failed"!==l.status)||void 0)),le=W((()=>{const e=m("labelWidth"),t=m("labelAlign");if(e&&"top"!==t)return{width:V(e)}})),de=a=>{if(13===a.keyCode){c&&c.props.submitOnEnter||"textarea"===e.type||i(a),"search"===e.type&&J()}t("keypress",a)},me=()=>e.id||`${n}-input`,pe=()=>{const t=ge("control",[m("inputAlign"),{error:ne.value,custom:!!a.input,"min-height":"textarea"===e.type&&!e.autosize}]);if(a.input)return $("div",{class:t,onClick:Z},[a.input()]);const l={id:me(),ref:o,name:e.name,rows:void 0!==e.rows?+e.rows:void 0,class:t,disabled:m("disabled"),readonly:m("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${n}-label`:void 0,onBlur:Y,onFocus:X,onInput:G,onClick:Z,onChange:ie,onKeypress:de,onCompositionend:ie,onCompositionstart:se};return"textarea"===e.type?$("textarea",l,null):$("input",_("number"===(r=e.type)?{type:"text",inputmode:"decimal"}:"digit"===r?{type:"tel",inputmode:"numeric"}:{type:r},l),null);var r},fe=()=>{const t=a["right-icon"];if(e.rightIcon||t)return $("div",{class:ge("right-icon"),onClick:ae},[t?t():$(s,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},ve=()=>{if(e.showWordLimit&&e.maxlength){const t=ue(d());return $("div",{class:ge("word-limit")},[$("span",{class:ge("word-num")},[t]),H("/"),e.maxlength])}},he=()=>{if(c&&!1===c.props.showErrorMessage)return;const t=e.errorMessage||l.validateMessage;if(t){const e=a["error-message"],n=m("errorMessageAlign");return $("div",{class:ge("error-message",n)},[e?e({message:t}):t])}},be=()=>[$("div",{class:ge("body")},[pe(),y.value&&$(s,{ref:r,name:e.clearIcon,class:ge("clear")},null),fe(),a.button&&$("div",{class:ge("button")},[a.button()])]),ve(),he()];return g({blur:J,focus:N,validate:z,formValue:S,resetValidation:w,getValidationStatus:()=>l.status}),F(B,{customValue:u,resetValidation:w,validateWithTrigger:K}),D((()=>e.modelValue),(()=>{U(d()),w(),K("onChange"),O(Q)})),R((()=>{U(d(),e.formatTrigger),O(Q)})),C("touchstart",(e=>{i(e),t("update:modelValue",""),t("clear",e)}),{target:W((()=>{var e;return null==(e=r.value)?void 0:e.$el}))}),()=>{const t=m("disabled"),l=m("labelAlign"),o=(()=>{const t=a["left-icon"];if(e.leftIcon||t)return $("div",{class:ge("left-icon"),onClick:ee},[t?t():$(s,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])})();return $(M,{size:e.size,class:ge({error:ne.value,disabled:t,[`label-${l}`]:l}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:le.value,valueClass:ge("value"),titleClass:[ge("label",[l,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:o&&"top"!==l?()=>o:null,title:()=>{const t=(()=>{const t=m("labelWidth"),l=m("labelAlign"),o=m("colon")?":":"";return a.label?[a.label(),o]:e.label?$("label",{id:`${n}-label`,for:a.input?void 0:me(),onClick:e=>{i(e),N()},style:"top"===l&&t?{width:V(t)}:void 0},[e.label+o]):void 0})();return"top"===l?[o,t].filter(Boolean):t||[]},value:be,extra:a.extra})}}}));const pe=X({name:"login",props:{},components:{},data:()=>({username:"",password:""}),computed:{},methods:{async getData(){},onSubmit(e){this.confirmSubmit(e)},async confirmSubmit(e){console.log(e);let t={username:e.username,password:e.password};const a=await this.$http.login(t);0==a.code&&(this.$msg.success("登录成功"),K(a.data.token),U())}},created(){this.getData()}},[["render",function(e,t,a,n,l,o){const r=me,s=A,i=ee,u=le;return G(),J("div",{class:""},[$(u,{onSubmit:o.onSubmit},{default:N((()=>[$(s,{inset:""},{default:N((()=>[$(r,{modelValue:l.username,"onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),$(r,{modelValue:l.password,"onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])])),_:1}),Q("div",{style:{margin:"16px"}},[$(i,{round:"",block:"",type:"primary","native-type":"submit"},{default:N((()=>[H(" 提交 ")])),_:1})])])),_:1},8,["onSubmit"])])}]]);export{pe as default};
